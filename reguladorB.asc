Version 4
SHEET 1 4368 1556
WIRE 128 -336 -208 -336
WIRE 336 -336 128 -336
WIRE 528 -336 336 -336
WIRE 768 -336 624 -336
WIRE 2224 -336 768 -336
WIRE 2272 -336 2224 -336
WIRE 2400 -336 2352 -336
WIRE 3040 -336 2400 -336
WIRE 3632 -336 3040 -336
WIRE 128 -288 128 -336
WIRE 336 -272 336 -336
WIRE 2224 -272 2224 -336
WIRE 2400 -272 2400 -336
WIRE 3040 -224 3040 -336
WIRE 128 -176 128 -208
WIRE 336 -176 336 -192
WIRE 2224 -160 2224 -192
WIRE 2224 -160 2128 -160
WIRE 1568 -144 1104 -144
WIRE 1600 -144 1568 -144
WIRE 1728 -144 1680 -144
WIRE 2016 -144 1728 -144
WIRE 2064 -144 2016 -144
WIRE 224 -128 192 -128
WIRE 272 -128 224 -128
WIRE 576 -128 576 -272
WIRE 608 -128 576 -128
WIRE 768 -128 768 -336
WIRE 768 -128 704 -128
WIRE 2160 -128 2128 -128
WIRE 2400 -128 2400 -192
WIRE 2400 -128 2160 -128
WIRE 1568 -112 1568 -144
WIRE 2224 -64 2224 -160
WIRE 128 -48 128 -80
WIRE 224 -48 224 -128
WIRE 224 -48 128 -48
WIRE 336 -48 336 -80
WIRE 592 -48 336 -48
WIRE 656 -48 656 -64
WIRE 656 -48 592 -48
WIRE 2016 -16 2016 -144
WIRE 2048 -16 2016 -16
WIRE 2160 -16 2160 -128
WIRE 2160 -16 2128 -16
WIRE 1568 0 1568 -32
WIRE 2224 64 2224 16
WIRE -352 80 -352 48
WIRE 128 112 128 -48
WIRE 336 112 336 -48
WIRE 64 160 48 160
WIRE 432 160 400 160
WIRE 3632 176 3632 -336
WIRE -352 192 -352 160
WIRE 592 192 592 -48
WIRE 1104 224 1104 -144
WIRE 1104 224 960 224
WIRE 128 240 128 208
WIRE 240 240 128 240
WIRE 336 240 336 208
WIRE 336 240 240 240
WIRE 720 240 656 240
WIRE 880 240 800 240
WIRE 896 240 880 240
WIRE 1104 256 960 256
WIRE 2160 288 2000 288
WIRE 2240 288 2160 288
WIRE 2640 288 2320 288
WIRE 2864 288 2640 288
WIRE 3040 288 3040 -144
WIRE 3040 288 2864 288
WIRE 3184 288 3040 288
WIRE 1808 304 1712 304
WIRE 1904 304 1888 304
WIRE 1936 304 1904 304
WIRE 2048 320 2000 320
WIRE 1968 352 1968 336
WIRE 2160 352 2160 288
WIRE 3040 352 3040 288
WIRE 3184 352 3184 288
WIRE -352 384 -352 352
WIRE -160 384 -160 160
WIRE 592 384 592 288
WIRE 1904 384 1904 304
WIRE 2048 384 2048 320
WIRE 2048 384 1904 384
WIRE 880 400 880 240
WIRE 928 400 880 400
WIRE 1104 400 1104 256
WIRE 1104 400 1008 400
WIRE 2160 480 2160 432
WIRE -352 496 -352 464
WIRE 3040 496 3040 432
WIRE 3184 496 3184 432
WIRE 3184 496 3040 496
WIRE -160 560 -160 464
WIRE -48 560 -160 560
WIRE 3040 592 3040 496
WIRE 3040 592 2912 592
WIRE -160 608 -160 560
WIRE 240 608 240 240
WIRE 2128 608 1984 608
WIRE 2192 608 2128 608
WIRE 2320 608 2272 608
WIRE 1712 624 1712 304
WIRE 1712 624 1632 624
WIRE 1744 624 1712 624
WIRE 1856 624 1824 624
WIRE 1920 624 1856 624
WIRE 1104 640 1104 400
WIRE 1200 640 1104 640
WIRE 1472 640 1280 640
WIRE 1568 640 1472 640
WIRE 2032 640 1984 640
WIRE 3040 640 3040 592
WIRE -48 656 -48 560
WIRE -48 656 -96 656
WIRE 176 656 -48 656
WIRE 1696 656 1632 656
WIRE -352 704 -352 624
WIRE 2912 720 2912 592
WIRE 3200 720 3088 720
WIRE 3376 720 3280 720
WIRE 1856 752 1856 624
WIRE 2032 752 2032 640
WIRE 2032 752 1856 752
WIRE 1472 768 1472 640
WIRE 1536 768 1472 768
WIRE 1664 768 1616 768
WIRE 1696 768 1696 656
WIRE 1696 768 1664 768
WIRE 2128 784 2128 608
WIRE 3376 800 3376 720
WIRE -352 816 -352 784
WIRE 1664 816 1664 768
WIRE -160 832 -160 704
WIRE 240 832 240 704
WIRE 2912 880 2912 800
WIRE 432 912 432 160
WIRE 2640 912 2640 288
WIRE 2640 912 432 912
WIRE -160 1008 -160 912
WIRE 240 1008 240 912
WIRE 240 1008 -160 1008
WIRE 592 1008 592 464
WIRE 592 1008 240 1008
WIRE 976 1008 592 1008
WIRE 1664 1008 1664 896
WIRE 1664 1008 976 1008
WIRE 2128 1008 2128 864
WIRE 2128 1008 1664 1008
WIRE 2912 1008 2912 960
WIRE 2912 1008 2128 1008
WIRE 3040 1008 3040 736
WIRE 3040 1008 2912 1008
WIRE 3376 1008 3376 880
WIRE 3376 1008 3040 1008
WIRE 3632 1008 3632 256
WIRE 3632 1008 3376 1008
WIRE 976 1072 976 1008
FLAG 976 1072 0
FLAG -352 192 0
FLAG -352 496 0
FLAG -352 48 Vreg
FLAG -208 -336 Vreg
FLAG -352 352 Vref
FLAG 48 160 Vref
FLAG 1728 -144 Vs
FLAG 2160 480 0
FLAG 1472 640 Vref-c
FLAG 1568 0 0
FLAG 2320 608 Vref
FLAG 2864 288 Vf
FLAG 2224 64 0
FLAG 976 1008 0V
FLAG 2096 -176 0V
FLAG 928 208 0V
FLAG 1968 272 0V
FLAG 1952 592 0V
FLAG 1600 608 0V
FLAG -352 816 0
FLAG -352 624 5v
FLAG 1968 352 5v
FLAG 2096 -112 5v
FLAG 1952 656 5v
FLAG 1600 672 5v
FLAG 928 272 5v
FLAG 3632 -336 Vo
FLAG -160 160 Vref
DATAFLAG 48 160 ""
DATAFLAG 336 -16 ""
DATAFLAG 128 32 ""
DATAFLAG 3536 -336 ""
DATAFLAG 2128 -336 ""
DATAFLAG 1936 -144 ""
DATAFLAG 1104 160 ""
DATAFLAG 1104 304 ""
DATAFLAG 832 240 ""
DATAFLAG 2544 288 ""
DATAFLAG 2128 688 ""
DATAFLAG 1872 624 ""
DATAFLAG 1360 640 ""
SYMBOL npn 64 112 R0
SYMATTR InstName Q1
SYMATTR Value TR1
SYMBOL npn 400 112 M0
SYMATTR InstName Q2
SYMATTR Value TR1
SYMBOL npn 608 -64 R270
SYMATTR InstName Q3
SYMATTR Value 2N2222
SYMBOL npn 176 608 R0
SYMATTR InstName Q5
SYMATTR Value BC547B
SYMBOL npn -96 608 M0
SYMATTR InstName Q6
SYMATTR Value BC547B
SYMBOL res -176 368 R0
SYMATTR InstName R1
SYMATTR Value 100
SYMBOL res 320 -288 R0
SYMATTR InstName R2
SYMATTR Value 0.1k
SYMBOL res 112 -304 R0
SYMATTR InstName R3
SYMATTR Value 0.1k
SYMBOL res 3616 160 R0
SYMATTR InstName RL
SYMATTR Value R=100*(1-time)
SYMBOL pnp 624 -272 M270
SYMATTR InstName Q7
SYMATTR Value tip42C
SYMBOL pnp 272 -80 M180
SYMATTR InstName Q8
SYMATTR Value BC557B
SYMBOL pnp 192 -80 R180
SYMATTR InstName Q9
SYMATTR Value BC557B
SYMBOL voltage -352 64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value {VINDC}
SYMBOL voltage -352 368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 1.2
SYMBOL res 2208 -288 R0
SYMATTR InstName R7
SYMATTR Value 2.2k
SYMBOL res 2384 -288 R0
SYMATTR InstName R8
SYMATTR Value 2.2k
SYMBOL res 2208 -80 R0
SYMATTR InstName R9
SYMATTR Value 22k
SYMBOL res 2144 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 22k
SYMBOL res 2176 592 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 2.2k
SYMBOL res 2112 880 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R12
SYMATTR Value 910
SYMBOL res 1728 608 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 1.1k
SYMBOL res 1520 752 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL res 1792 288 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 1k
SYMBOL res 2224 272 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL res 2144 448 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 11k
SYMBOL res 1184 656 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R20
SYMATTR Value 2.2k
SYMBOL res 816 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 32k
SYMBOL res 576 368 R0
SYMATTR InstName R23
SYMATTR Value 47
SYMBOL res 1680 800 M0
SYMATTR InstName R24
SYMATTR Value 1k
SYMBOL res 912 416 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R21
SYMATTR Value 82k
SYMBOL res 1696 -160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R200
SYMATTR Value 2.2k
SYMBOL res 1584 -16 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R19
SYMATTR Value 82k
SYMBOL res 2256 -320 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value 0.1
SYMBOL npn 656 192 M0
SYMATTR InstName Q4
SYMATTR Value 2N2222
SYMBOL OpAmps\\opamp2 1600 704 R180
WINDOW 3 -110 102 Left 2
SYMATTR Value LM324
SYMATTR InstName U6
SYMBOL OpAmps\\opamp2 2096 -80 R180
WINDOW 3 -116 99 Left 2
SYMATTR Value TLV2371
SYMATTR InstName U2
SYMBOL OpAmps\\opamp2 928 304 R180
WINDOW 3 -110 102 Left 2
SYMATTR Value LM324
SYMATTR InstName U1
SYMBOL OpAmps\\opamp2 1968 368 R180
WINDOW 3 -110 102 Left 2
SYMATTR Value LM324
SYMATTR InstName U3
SYMBOL OpAmps\\opamp2 1952 688 R180
WINDOW 3 -110 102 Left 2
SYMATTR Value LM324
SYMATTR InstName U4
SYMBOL voltage -352 688 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 5
SYMBOL res 3024 -240 R0
SYMATTR InstName R5
SYMATTR Value 3.3k
SYMBOL res 3024 336 R0
SYMATTR InstName R6
SYMATTR Value 2.2k
SYMBOL res 3168 336 R0
SYMATTR InstName R26
SYMATTR Value 2.4k
SYMBOL nmos 3088 640 M0
WINDOW 3 -116 -25 Left 2
SYMATTR Value BSZ100N03LS
SYMATTR InstName M1
SYMBOL res 3296 704 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 1k
SYMBOL voltage 3376 784 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 0
SYMBOL res 2896 704 R0
SYMATTR InstName R27
SYMATTR Value 1.1k
SYMBOL res 2896 864 R0
SYMATTR InstName R29
SYMATTR Value 20
SYMBOL res -176 816 R0
SYMATTR InstName R18
SYMATTR Value 10
SYMBOL res 224 816 R0
SYMATTR InstName R25
SYMATTR Value 10
TEXT 224 -536 Left 2 !;step param RE 1k 1.5k 100
TEXT 224 -616 Left 2 !;param RL=6
TEXT 224 -656 Left 2 !.tran 0 0.9999999 0 1m
TEXT -224 -576 Left 2 !.include librerias/bd140.lib
TEXT -224 -528 Left 2 !.include librerias/complex_discretes.lib
TEXT 224 -504 Left 2 ;.op
TEXT 2392 232 Right 2 ;REFERENCIA
TEXT -224 -616 Left 2 !.inc opamp.sub
TEXT -224 -648 Left 2 !.lib librerias/LM324.ti.lib
TEXT -216 -688 Left 2 ;LIBRERIAS
TEXT 224 -696 Left 2 ;SIMULACIONES
TEXT 744 -664 Left 2 !.meas DC Vo1rl FIND V(Vo) AT=6.15
TEXT 744 -640 Left 2 !.meas DC Vo2rl FIND V(Vo) AT=6.35
TEXT 744 -616 Left 2 !.meas DC RegLin PARAM ((Vo2rl-Vo1rl)/1.85)
TEXT 752 -696 Left 2 ;Mido regulacion de linea
TEXT 1448 -664 Left 2 !.meas OP Vo1rc FIND V(Vo) AT 100
TEXT 1448 -640 Left 2 !.meas OP Vo2rc FIND V(Vo) AT 5
TEXT 1448 -616 Left 2 !.meas OP Io1rc FIND I(RL) AT 100
TEXT 1448 -592 Left 2 !.meas OP Io2rc FIND I(RL) AT 5
TEXT 1456 -696 Left 2 ;Mido regulacion de carga
TEXT 1984 -648 Left 2 ;-100*((V(vo)*I(RL))/(V(Vreg)*I(V1)))
TEXT 1992 -680 Left 2 ;Mido eficiencia
TEXT -224 -464 Left 2 ;.dc V1 2 10 0.1
TEXT -688 -96 Left 2 !.param VINDC 6.25
TEXT -208 -776 Left 2 !.lib librerias/tlv2731.lib
