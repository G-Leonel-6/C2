Version 4
SHEET 1 1612 680
WIRE 1152 -400 1152 -432
WIRE 1152 -304 1152 -320
WIRE 1312 -256 1312 -272
WIRE 1312 -256 1296 -256
WIRE 1328 -256 1312 -256
WIRE 1296 -240 1296 -256
WIRE 1312 -240 1312 -256
WIRE 1328 -240 1328 -256
WIRE 1152 -208 1152 -224
WIRE 1200 -208 1152 -208
WIRE 1280 -208 1200 -208
WIRE 272 -176 224 -176
WIRE 400 -176 272 -176
WIRE 528 -176 400 -176
WIRE 768 -176 624 -176
WIRE 960 -176 768 -176
WIRE 1280 -176 960 -176
WIRE 1472 -176 1360 -176
WIRE 768 -128 768 -176
WIRE 960 -128 960 -176
WIRE 1152 -128 1152 -208
WIRE 576 -80 576 -112
WIRE 400 -64 400 -176
WIRE 416 -64 400 -64
WIRE 576 -64 576 -80
WIRE 576 -64 496 -64
WIRE 224 -48 224 -176
WIRE 1392 -48 1232 -48
WIRE 576 -16 576 -64
WIRE 1152 0 1152 -48
WIRE 768 16 768 -48
WIRE 768 16 608 16
WIRE 960 16 960 -48
WIRE 1088 16 960 16
WIRE 1280 32 1280 0
WIRE 1232 48 1232 -48
WIRE 1248 48 1232 48
WIRE 960 64 960 16
WIRE 1392 64 1392 -48
WIRE 1392 64 1312 64
WIRE 1456 64 1392 64
WIRE 768 80 768 16
WIRE 1088 80 1088 16
WIRE 1248 80 1088 80
WIRE 1280 128 1280 96
WIRE 224 176 224 32
WIRE 576 176 576 48
WIRE 576 176 224 176
WIRE 768 176 768 160
WIRE 768 176 576 176
WIRE 960 176 960 144
WIRE 960 176 768 176
WIRE 576 192 576 176
FLAG 576 192 0
FLAG 960 -176 Vo
FLAG 1456 64 Vref
FLAG 272 -176 Vin
FLAG 1312 -272 0
FLAG 1152 0 0
FLAG 1472 -176 Ven
FLAG 1200 -208 V+
FLAG 768 16 r
FLAG 1280 128 0
FLAG 1152 -432 Vin
FLAG 1312 -144 Vin
FLAG 1280 0 Vin
FLAG 576 -80 vb
SYMBOL tl431 592 -16 M0
SYMATTR InstName U1
SYMBOL npn 528 -112 R270
SYMATTR InstName Q1
SYMATTR Value BC847B
SYMBOL res 512 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 3.3k
SYMBOL voltage 224 -64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 11.9
SYMBOL res 752 -144 R0
SYMATTR InstName R2
SYMATTR Value 30k
SYMBOL res 752 64 R0
SYMATTR InstName R3
SYMATTR Value 24.7k
SYMBOL res 944 -144 R0
SYMATTR InstName R4
SYMATTR Value 3.6k
SYMBOL res 944 48 R0
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL Comparators\\LT1016 1312 -128 M180
SYMATTR InstName U2
SYMBOL res 1136 -416 R0
SYMATTR InstName R6
SYMATTR Value 11k
SYMBOL res 1136 -144 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL OpAmps\\opamp2 1280 0 R0
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL res 1136 -320 R0
SYMATTR InstName R8
SYMATTR Value 270
TEXT -328 24 Left 2 !.op
TEXT -328 -16 Left 2 !.include TL431.lib
TEXT -328 -48 Left 2 !.include LM324.ti.lib
